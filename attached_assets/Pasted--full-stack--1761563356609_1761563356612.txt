Цель: Разработать полнофункциональный full-stack веб-продукт для автоматизации составления учебного расписания. Интерфейс — на русском языке, современный классический дизайн с анимациями, цветовая гамма — вдохновлённая рассветками белорусского университета МИТСО (светлые градиенты, акценты синего и золотистого). БД — PostgreSQL. Один репозиторий с фронтом и бэком (fullstack). Всё работает надёжно, без ошибок. Автоматическая генерация расписания — без ИИ, алгоритм-решатель конфликтов по ограничениям. Авторизация — собственная (без Replit Auth); админ создаёт пользователей (логин = ФИО, пароль задаёт админ).

Общее требование к реализации

Стек (предпочтительный, используйте если возможно):

Frontend: Next.js (React) + TypeScript (один проект, pages/app routing допустим). UI: Tailwind CSS + Framer Motion для анимаций.

Backend: API routes в Next.js или отдельный Node.js + Express/TypeScript (в одном репозитории проще — Next.js API routes).

ORM: Prisma для работы с PostgreSQL (миграции/сиды).

Аутентификация: JWT хранить в HttpOnly secure cookie (веб-приложение).

Hash паролей: bcrypt.

Тесты: Jest + React Testing Library для фронта + supertest для API.

Локализация: интерфейс полностью на русском (строки в i18n-файле).

Качество кода:

TypeScript типизация, ESLint, Prettier.

Документация: README с инструкцией по запуску, миграциям, сидированию БД, тестам и деплою.

CI: добавить простой workflow (тесты + сборка).

UI/UX:

Русский интерфейс.

Адаптивность (desktop → tablet → mobile).

Современный классический стиль с анимациями (плавные переходы, hover-эффекты, loading skeletons).

Палитра: белые фоновые панели, основной акцент — синий (пример #0B5BD7), золотистые акценты (пример #F9C846), мягкие градиенты на заголовках/баннерах.

Должно быть красиво и аккуратно; применяйте карточки, таблицы, фильтры.

Роли и права

Администратор (admin) — полный доступ:

Создаёт/редактирует/удаляет преподавателей, студентов, группы, предметы, аудитории.

Может задать логин (ФИО) и пароль пользователю при создании.

Запуск автоматической генерации расписания.

Просмотр логов конфликтов и истории изменений.

Преподаватель (teacher):

Просмотр своего расписания (время начала/окончания каждой пары).

Просмотр прикреплённых предметов и групп, в которых он преподаёт.

Студент (student):

Просмотр расписания своей группы (время начала/окончания).

Интерфейс показывает только расписание, релевантное его группе.

База данных — модель (Prisma schema / SQL)

Создать модели (пример для Prisma):

User:

id (UUID), role (enum: ADMIN, TEACHER, STUDENT), firstName, lastName, middleName, login (string — ФИО), passwordHash, createdAt, updatedAt, active.

Teacher:

id (UUID), userId -> User

Student:

id (UUID), userId -> User, groupId -> Group

Group:

id (UUID), name (например: БИО-21), year, course

Subject:

id, name, shortName, defaultDurationMinutes (use 85) — но расписание фиксировано: 1ч25мин

Audience (аудитория / кабинет):

id, name, capacity, resources (json)

LessonTemplate (привязка предмета к группе/преподавателю, глубинная сущность)

id, subjectId, groupId, teacherId, weeklyFrequency (число), preferredDays (array), preferredTimes (array)

Lesson (конкретная пара в расписании):

id, subjectId, groupId, teacherId, audienceId, startAt (datetime), endAt (datetime), createdBy (admin id)

ScheduleGenerationRun:

id, createdAt, summary (json), conflictCount, status

Indexes и внешние ключи.

API — минимальный список эндпоинтов

(все ответы на русском; авторизация через cookie)

POST /api/auth/login — { login, password } → устанавливает HttpOnly cookie, возвращает роль и профиль.

POST /api/auth/logout

GET /api/users (admin) — список пользователей

POST /api/users (admin) — создать user (указать роль, ФИО, пароль)

PUT /api/users/:id (admin)

DELETE /api/users/:id (admin)

GET /api/groups, POST /api/groups, PUT /api/groups/:id, DELETE /api/groups/:id

GET /api/teachers, GET /api/students

GET /api/subjects, CRUD

GET /api/audiences, CRUD

POST /api/schedule/generate (admin) — запускает генерацию расписания; возвращает отчет

GET /api/schedule — фильтрация по groupId / teacherId / dateRange

GET /api/schedule/:id

GET /api/schedule/run/:runId — получить лог/детали

Алгоритм автоматической генерации расписания (обязательная детальная спецификация)

Цель: автоматически разместить занятия (уроки) на недельном расписании с учётом ограничений и без конфликтов.

Вводные данные:

Набор LessonTemplate — сколько пар в неделю по предмету для группы, привязка к преподавателю.

Доступные дни (например, Пн–Пт) и рабочие часы (например, 08:00—20:00).

Время одной пары фиксировано: 1 час 25 минут (85 минут). Между парами минимальный междупарный интервал — 10 минут (на переход).

Список аудиторий с вместимостью и ограничениями.

Наличие ограничений предпочтений (например, преподаватель указывает «не в понедельник утром»).

Ограничения (hard constraints):

Нельзя назначить две пары одной группы в одно и то же время.

Нельзя назначить преподавателя на две пары одновременно.

В аудитории не может быть двух пар одновременно.

Уроки должны укладываться в рабочие часы.

Длительность пары фиксирована (85 минут), окончание = начало + 85 минут.

Междупарный интервал между занятиями одной группы/одного преподавателя должен быть >= 10 минут.

Аудитория должна соответствовать требованию (capacity >= group size, если группа size задана).

Цель оптимизации (soft constraints, по возможности):

Минимизировать «пустые» междупарные промежутки для преподавателя в один день.

Размещать пары одной группы компактно (минимизировать общий разброс по дню).

Учитывать preferredDays/preferredTimes.

Алгоритм (предложение реализации):

Формирование списка слотов: разбить рабочий день на возможные стартовые слоты (например, 08:00, 09:35, 11:20 и т.д.) с учётом длительности пары и 10 минут буфера — генерировать кандидаты.

Приоритетный порядок уроков: сортировать LessonTemplate по степени сложности (например, меньше возможных аудиторий или меньше допустимых временных окон — первыми назначать самые жёсткие).

Greedy + backtracking:

Для каждого урока в порядке приоритета попробовать все допустимые слоты и аудитории, проверяя жёсткие ограничения.

Если для урока не удаётся найти слот — откатиться (backtrack) на предыдущие назначения; ограничить глубину отката и применять эвристики (переместить менее приоритетные уроки).

Conflict detection & repair: после первичного прохода — сканировать конфликтные назначения и применять локальные перестановки (swap) для разрешения.

Финальный отчёт: вернуть статистику: сколько уроков назначено, список неразрешённых (если есть), время генерации, использованные эвристики.

Алгоритм должен быть детерминированным при одинаковых входных параметрах.

Требование: реализация должна быть устойчивой и комментированной — чтобы можно было улучшать эвристику позже. Не использовать внешнее ИИ.

UI — страницы и компоненты (краткий перечень)

Страница входа (Авторизация) — логин = ФИО, пароль.

Дашборд (для админа / преподавателя / студента) — краткая статистика и быстрые ссылки.

Админка / Управление:

Пользователи (создать преподавателя/студента; при создании — задать пароль).

Группы, предметы, аудитории.

Конструктор LessonTemplate (для задания частоты предмета по группе и привязки к преподавателю).

Кнопка/панель «Сгенерировать расписание» с настройками (дни, рабочие часы).

Просмотр результатов генерации и логов.

Просмотр расписания:

Табличный вид (день/время) и список предстоящих пар.

Возможность фильтрации по группе/преподавателю/аудитории.

Кард пары: предмет, преподаватель, аудитория, время начала/окончания.

Мобильный вид: вертикальный список дней/пар.

Настройки UI: переключение темы (светлая/контрастная), экспорт не нужен (по твоему требованию).

Дополнительные требования безопасности и эксплуатации

Пароли хранить bcrypt (salt).

Защищать API: только авторизованные пользователи имеют доступ к защищённым эндпоинтам; проверка роли на сервере.

Защита от CSRF (если нужна) — использовать sameSite cookies + CSRF token.

Логи генерации и изменений (какой админ, когда сделал изменение).

Обработка ошибок — красивый UI с сообщениями на русском.

Тесты и контроль качества

Покрыть критичные пути тестами:

API: создание/аутентификация/CRUD/генерация расписания (supertest).

Scheduler unit tests: тестирование конфликтных и неконфликтных наборов входных данных.

Frontend: smoke tests рендеринга ключевых страниц (React Testing Library).

Сценарии для ручного тестирования (в README).

Сид (seed) и миграции

Создать миграции Prisma.

Добавить script prisma db seed для создания:

1 admin (логин: Администратор Админович Админов, пароль: Admin123!), несколько преподавателей, групп, предметов, аудиторий и несколько шаблонов уроков — чтобы можно было сразу тестировать генератор.